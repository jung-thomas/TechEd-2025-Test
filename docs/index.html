<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
	<title>TechEd 2025 – Group Template Links</title>
	<link rel="icon" href="data:,">
	<!-- OpenUI5 Bootstrap (standalone, CDN) -->
	<script id="sap-ui-bootstrap"
				src="https://sdk.openui5.org/resources/sap-ui-core.js"
				data-sap-ui-theme="sap_horizon"
				data-sap-ui-libs="sap.m"
				data-sap-ui-async="true"
				data-sap-ui-compatVersion="edge"
				data-sap-ui-xx-waitForTheme="true">
	</script>
	<style>
		html, body, #content { height:100%; margin:0; }
		.techedIntroText { max-width: 42rem; }
	</style>
	<script>
	// Wait for UI5 core to be ready, then build the UI (no external module file needed)
	sap.ui.getCore().attachInit(function createApp() {
		const Shell = sap.m.Shell, App = sap.m.App, Page = sap.m.Page, Select = sap.m.Select,
			Item = sap.ui.core.Item, VBox = sap.m.VBox, Link = sap.m.Link, Label = sap.m.Label,
			Toolbar = sap.m.Toolbar, ToolbarSpacer = sap.m.ToolbarSpacer, Title = sap.m.Title, Text = sap.m.Text,
			SegmentedButton = sap.m.SegmentedButton, SegmentedButtonItem = sap.m.SegmentedButtonItem;

		// Theme handling (light/dark) with OS preference default & persistence
		const THEME_LIGHT = 'sap_horizon';
		const THEME_DARK = 'sap_horizon_dark';
		function getStoredTheme() { return localStorage.getItem('ui5ThemePref'); }
		function detectPreferredTheme() {
			const stored = getStoredTheme();
			if (stored === THEME_LIGHT || stored === THEME_DARK) return stored;
			if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) return THEME_DARK;
			return THEME_LIGHT;
		}
		const initialTheme = detectPreferredTheme();
		if (sap.ui.getCore().getConfiguration().getTheme() !== initialTheme) {
			sap.ui.getCore().applyTheme(initialTheme);
		}
		const themeToggle = new SegmentedButton({
			selectedKey: initialTheme,
			items: [
				new SegmentedButtonItem({key: THEME_LIGHT, text: 'Light'}),
				new SegmentedButtonItem({key: THEME_DARK, text: 'Dark'})
			],
			selectionChange: function(e){
				const key = e.getParameter('item').getKey();
				sap.ui.getCore().applyTheme(key);
				localStorage.setItem('ui5ThemePref', key);
			}
		});
		// React to OS scheme changes only if user hasn't chosen explicitly
		if (!getStoredTheme() && window.matchMedia) {
			const mq = window.matchMedia('(prefers-color-scheme: dark)');
			const listener = function(ev){
				const newTheme = ev.matches ? THEME_DARK : THEME_LIGHT;
				sap.ui.getCore().applyTheme(newTheme);
				themeToggle.setSelectedKey(newTheme);
			};
			if (mq.addEventListener) mq.addEventListener('change', listener); else if (mq.addListener) mq.addListener(listener);
		}

		const baseUrl = 'https://github.com/jung-thomas/TechEd-2025-Test/blob/main/templates/';

		const select = new sap.m.Select({
			width: '180px',
			autoAdjustWidth: true,
			ariaLabelledBy: 'groupSelectLabel',
			change: function(oEvt){
				const key = oEvt.getParameter('selectedItem').getKey();
				updateLinks(key);
			}
		});
		select.addItem(new Item({key:'', text:'Select Group...'}));
		['01','02','03','04','05'].forEach(g => select.addItem(new Item({key:g, text:'Group '+g})));

		const linksBox = new sap.m.VBox({
			visible: false,
			items: []
		});

		const exampleFiles = ['example1.txt','example2.txt','example3.txt'];
		const linkControls = exampleFiles.map(f => new sap.m.Link({
				text: f + ' (opens on GitHub)',
				target: '_blank',
				href: 'javascript:void(0);'
		}));
		linkControls.forEach(l => linksBox.addItem(l));

		function updateLinks(group) {
			const visible = !!group;
			linksBox.setVisible(visible);
			if (!visible) return;
			const groupPath = 'TechEd-Group-' + group + '/';
			linkControls.forEach((link, idx) => {
				const file = exampleFiles[idx];
				const href = baseUrl + groupPath + file;
				link.setHref(href);
			});
		}

		const intro = new sap.m.Text({
			text: 'Choose your TechEd group number to access the three example template files directly on GitHub.'
		}).addStyleClass('techedIntroText');

		const formBox = new sap.m.VBox({
			width: '100%',
			items: [
				new sap.m.Label('groupSelectLabel', { text: 'Group Number', labelFor: select }),
				select,
				linksBox
			],
			renderType: 'Div',
			fitContainer: false
		}).addStyleClass('sapUiSmallMarginTop');

		const page = new sap.m.Page({
			title: 'TechEd 2025 – Template Links',
			subHeader: new Toolbar({
				content: [
					new Title({text:'TechEd 2025'}),
					new ToolbarSpacer(),
					new Text({text:'Theme:'}),
					themeToggle
				]
			}),
			content: [intro, formBox],
			footer: new sap.m.Toolbar({
				content: [
					new sap.m.Title({text:'TechEd 2025'}),
						new sap.m.ToolbarSpacer(),
						new sap.m.Text({text:'Example Exercise Workshop Template Links'})
				]
			})
		});

		const app = new sap.m.App({initialPage: page.getId()});
		app.addPage(page);

		new Shell({
			app: app,
			title: 'TechEd 2025',
			showLogout: false
		}).placeAt('content');
	});
	</script>
</head>
<body class="sapUiBody" id="content" role="application">
	<noscript>Please enable JavaScript to use this application.</noscript>
</body>
</html>